<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Signarama Helper</title>
  <style>
    :root {
      font-family: ui-sans-serif,-apple-system,Segoe UI,Roboto,Arial;
      color:#eee;
      --signarama-red:#c8102e;
    }
    html, body { height:100%; }
    body { margin:0; background:#1f1f1f; display:flex; flex-direction:column; min-width:280px; min-height:380px; }
    header { padding:12px; font-weight:800; border-bottom:1px solid #333; background:#121212; display:flex; align-items:center; justify-content:space-between; }
    .brand { display:flex; align-items:center; gap:8px; }
    .brand-logo {
      width:24px;
      height:24px;
      border-radius:6px;
      overflow:hidden;
      border:1px solid #5a0c1c;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  4px 6px 8px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
      background:var(--signarama-red);
      flex:0 0 auto;
    }
    .brand-title { font-weight:800; }
    .tabs { display:flex; gap:6px; padding:8px 10px; border-bottom:1px solid #333; background:#161616; flex-wrap:wrap; }
    .tab {
      appearance:none;
      border:1px solid #333;
      background:#202020;
      color:#ddd;
      border-radius:999px;
      padding:6px 10px;
      font-size:12px;
      font-weight:700;
      cursor:pointer;
    }
    .tab.active {
      background:var(--signarama-red);
      border-color:#8f0d23;
      color:#fff;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  4px 6px 8px rgba(0,0,0,0.35),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .tab:focus,
    .tab:focus-visible {
      outline:none;
      box-shadow:none;
    }
    .tab.active:focus,
    .tab.active:focus-visible {
      outline:none;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  4px 6px 8px rgba(0,0,0,0.35),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .content { flex:1; overflow:auto; }
    .wrap { padding:12px; display:grid; gap:10px; }

    .btn {
      width:100%;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px;
      background:#2a2a2a; color:#eee;
      border:1px solid #444; border-radius:12px;
      padding:12px 12px;
      cursor:pointer;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  5px 8px 10px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
      font-size:13px;
      text-align:left;
    }
    .btn:hover { background:#242424; }
    .btn:active { transform: translateY(1px); }
    .btnText { font-weight:800; }
    .btnMeta { display:flex; align-items:center; gap:10px; }
    .btnOpt { display:flex; align-items:center; gap:6px; font-size:12px; color:#d8d8d8; user-select:none; }
    .btnOpt input { width:14px; height:14px; }
    .btnQuality {
      min-width:86px;
      padding:4px 6px;
      font-size:12px;
      border-radius:8px;
    }

    .info {
      flex:0 0 auto;
      width:22px; height:22px;
      display:grid; place-items:center;
      border-radius:999px;
      border:1px solid #555;
      background:#121212;
      color:#cfcfcf;
      font-size:12px;
      line-height:1;
      user-select:none;
    }
    .info:hover { border-color:#777; color:#fff; }

    .card { border:1px solid #000; border-radius:12px; background:#161616; padding:12px; box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12), 5px 8px 10px rgba(0,0,0,0.45), 0 0px 1px rgba(0,0,0,0.6); }
    .cardHead { display:flex; align-items:center; justify-content:space-between; gap:10px; margin-bottom:8px; }
    .cardTitle { font-weight:800; }
    .small { color:#aaa; font-size:12px; line-height:1.35; }
    .chk { display:flex; align-items:center; gap:8px; font-size:13px; color:#ddd; user-select:none; }
    .chk input { width:14px; height:14px; }
    #log, .log { white-space:pre-wrap; font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
                 font-size:11px; color:#cfcfcf; padding:10px; border:1px solid #333; border-radius:10px; background:#101010; height:240px; overflow:auto; }
    .grid2 { display:grid; grid-template-columns: 1fr 1fr; gap:8px; }
    .grid3 { display:grid; grid-template-columns: repeat(3, 1fr); gap:8px; }
    .dim-grid { display:grid; grid-template-columns: repeat(3, 1fr); gap:8px; }
    .dim-btn {
      display:grid; place-items:center;
      background:#2a2a2a; color:#eee;
      border:1px solid #444; border-radius:12px;
      padding:10px;
      cursor:pointer;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  5px 8px 10px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
      height:70px;
    }
    .dim-btn:hover { background:#242424; }
    .dim-btn svg { width:50px; height:50px; }
    .dim-selection-hint {
      margin-top:8px;
      text-align:center;
    }
    .dim-center {
      display:grid; place-items:center;
      color:#bbb;
      border:1px dashed #444;
      border-radius:12px;
      background:#202020;
      height:70px;
      font-size:12px;
    }
    .row { display:flex; gap:10px; align-items:flex-end; }
    .fld { display:flex; flex-direction:column; gap:4px; }
    .fld span { font-size:12px; color:#bcbcbc; }
    input, select {
      background:#101010; color:#eee;
      border:1px solid #333; border-radius:10px;
      padding:8px 10px; font-size:13px;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.08);
      outline:none;
    }
    input:focus, select:focus { border-color:#555; }
    .btn2 {
      background:#2a2a2a; color:#eee;
      border:1px solid #444; border-radius:12px;
      padding:10px 12px;
      cursor:pointer;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  5px 8px 10px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
      font-size:13px; font-weight:800;
      white-space:nowrap;
      display:flex; align-items:center; justify-content:space-between; gap:10px;
    }
    .btn2:hover { background:#242424; }
    .btn2:active { transform: translateY(1px); }
    .artboards-wrap { margin-top:10px; border:1px solid #333; border-radius:10px; padding:8px; background:#121212; }
    .artboards-head { display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px; }
    .artboards-list { max-height:160px; overflow:auto; border:1px solid #2d2d2d; border-radius:8px; padding:6px; background:#0f0f0f; }
    .artboards-empty { font-size:12px; color:#9e9e9e; padding:6px; }

    .hidden { display:none; }

    .artboard-scale-banner {
      margin-top:10px;
      padding:8px 10px;
      border-radius:10px;
      border:1px solid #3a3a3a;
      background:#131313;
      color:#d5d5d5;
      font-size:12px;
      display:flex;
      align-items:center;
      gap:8px;
      font-weight:700;
    }
    .artboard-scale-banner.large {
      border-color:#7a5f00;
      background:#2b2200;
      color:#ffd35a;
    }
    .bleed-options-card {
      display:flex;
      flex-direction:column;
      gap:8px;
      padding:10px 12px;
      border:1px solid #444;
      border-radius:12px;
      background:#202020;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  5px 8px 10px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .theme-grid {
      margin-top:10px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:8px;
    }
    .theme-tile {
      position:relative;
      min-height:62px;
      border:1px solid #444;
      border-radius:12px;
      cursor:pointer;
      background:#202020;
      padding:6px;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.12),
                  5px 8px 10px rgba(0,0,0,0.45),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .theme-tile:hover { filter:brightness(1.06); }
    .theme-tile:active { transform: translateY(1px); }
    .theme-tile-inner {
      width:100%;
      height:100%;
      border-radius:8px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,0.12);
      display:grid;
      grid-template-columns: 1fr 1fr;
      background:#111;
    }
    .theme-half { width:100%; height:100%; }
    .theme-half + .theme-half { border-left:1px solid rgba(255,255,255,0.28); }
    .origin-grid {
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:8px;
    }
    .origin-btn {
      height:34px;
      border:1px solid #444;
      border-radius:10px;
      background:#202020;
      color:#d6d6d6;
      cursor:pointer;
      font-size:12px;
      font-weight:700;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.10),
                  4px 6px 8px rgba(0,0,0,0.35),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .origin-btn:focus,
    .origin-btn:focus-visible {
      outline:none;
      box-shadow: inset 0px 1px 2px rgba(255,255,255,0.10),
                  4px 6px 8px rgba(0,0,0,0.35),
                  0 0px 1px rgba(0,0,0,0.6);
    }
    .origin-btn.active {
      border-color:#5a5a5a;
      background:#3a3a3a;
      color:#fff;
    }
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <svg class="brand-logo" viewBox="0 0 24 24" aria-hidden="true" focusable="false">
        <rect x="0" y="0" width="24" height="24" fill="#c8102e"/>
        <path d="M6 8c0-2 1.7-3.5 4.3-3.5h7v3h-6.6c-.9 0-1.5.3-1.5.9s.6.9 1.8 1.2l2 .5c2.8.7 4.4 1.8 4.4 4 0 2.4-2 4-5 4H6v-3h6.2c1.1 0 1.8-.4 1.8-1.1s-.7-1-2-1.4l-2.2-.6C7.5 11.4 6 10.3 6 8z" fill="#ffffff"/>
      </svg>
      <div class="brand-title">Signarama Helper</div>
    </div>
    <div style="font-size:12px; color:#aaa; font-weight:700;" id="status"></div>
  </header>

  <div class="tabs" role="tablist" aria-label="Signarama Helper Tabs">
    <button class="tab active" data-tab="tab-buttons" type="button">Artboards</button>
    <button class="tab" data-tab="tab-bleeds" type="button">Bleeds</button>
    <button class="tab" data-tab="tab-cutfiles" type="button">Router/Laser</button>
    <button class="tab" data-tab="tab-dimensions" type="button">Dimensions</button>
    <button class="tab" data-tab="tab-transform" type="button">Transform</button>
    <button class="tab" data-tab="tab-lightbox" type="button">Lightbox</button>
    <button class="tab" data-tab="tab-corebridge" type="button">Corebridge</button>
    <button class="tab" data-tab="tab-colours" type="button">Colours</button>
    <button class="tab" data-tab="tab-testing" type="button">Testing</button>
  </div>

  <div class="content">
    <!-- TAB: BUTTONS -->
    <section id="tab-buttons" class="wrap" role="tabpanel">
      <button class="btn" id="btnFitArtboard" type="button">
        <span class="btnText">Fit artboard to artwork</span>
        <span class="info" data-tip="Fits the active artboard to the document items bounding box (no selection required).">i</span>
      </button>

      <button class="btn" id="btnArtboardPerItem" type="button">
        <span class="btnText">Artboard per selection</span>
        <span class="info" data-tip="Creates a new artboard for each selected item and fits it to the item bounds.">i</span>
      </button>

      <button class="btn" id="btnCopyOutlineScaleA4" type="button">
        <span class="btnText">Scale Artwork for Proof (A4)</span>
        <span class="btnMeta">
          <label class="btnOpt" for="a4Rasterize">
            <input id="a4Rasterize" type="checkbox">
            <span>Rasterize</span>
          </label>
          <select id="a4RasterizeQuality" class="btnQuality" title="Rasterize quality">
            <option value="draft">72 dpi</option>
            <option value="medium">150 dpi</option>
            <option value="high" selected>300 dpi</option>
            <option value="print">600 dpi</option>
            <option value="ultra">1200 dpi</option>
            <option value="max">2400 dpi</option>
            <option value="super">7200 dpi</option>
            <option value="insane">30000 dpi</option>
          </select>
          <span class="info" data-tip="Copy -> Scale -> Scale strokes (optional rasterize)">i</span>
        </span>
      </button>
    </section>

    <!-- TAB: BLEEDS -->
    <section id="tab-bleeds" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Bleeds to Basics (Rect, Circle)</div>
          <span class="info" data-tip="All inputs are millimetres. Expands the current selection by Top/Right/Bottom/Left.">i</span>
        </div>

        <div class="grid2">
          <label class="fld">
            <span>Top (mm)</span>
            <input id="bleedTop" type="number" step="0.1" value="0">
          </label>
          <label class="fld">
            <span>Right (mm)</span>
            <input id="bleedRight" type="number" step="0.1" value="0">
          </label>
          <label class="fld">
            <span>Bottom (mm)</span>
            <input id="bleedBottom" type="number" step="0.1" value="0">
          </label>
          <label class="fld">
            <span>Left (mm)</span>
            <input id="bleedLeft" type="number" step="0.1" value="0">
          </label>
        </div>

        <div class="row" style="margin-top:10px;">
          <label class="fld" style="flex:1;">
            <span>Quick fill</span>
            <select id="bleedPreset">
              <option value="acm" selected>ACM (20mm each side)</option>
              <option value="windowGraphics">Window Graphics (T0 L0 R20 B20)</option>
              <option value="wallGraphics">Wall Graphics (T20 L0 R50 B50)</option>
              <option value="flyers">Flyers (2mm each side)</option>
              <option value="aframes">AFrames (20mm each side)</option>
              <option value="pullupBanners">Pull-up banners (B100)</option>
              <option value="none">None (0)</option>
            </select>
          </label>

          <button class="btn2" id="btnApplyBleed" type="button">
            <span>Apply bleed</span>
            <span class="info" data-tip="Expands selected items by the given amounts, handling asymmetric bleeds.">i</span>
          </button>
        </div>
        <div class="row" style="margin-top:8px; align-items:flex-start;">
          <div class="bleed-options-card">
            <label class="chk">
              <input id="bleedKeepOriginal" type="checkbox" checked>
              <span>Keep original</span>
            </label>
            <label class="chk">
              <input id="bleedExcludeClippedContent" type="checkbox" checked>
              <span>Exclude clipped content</span>
            </label>
            <label class="chk">
              <input id="bleedExpandArtboards" type="checkbox" checked>
              <span>Expand artboards</span>
            </label>
          </div>
        </div>

        <div class="small" style="margin-top:8px;">
          Note: this expands artwork bounds. Artboards expand only when "Expand artboards" is enabled.
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Bleeds to paths (Offset Path)</div>
          <span class="info" data-tip="Applies a true Offset Path bleed (mitre join, miter limit 180). Intended for paths/letters/shapes. All units mm.">i</span>
        </div>

        <div class="row">
          <label class="fld" style="flex:1;">
            <span>Offset amount (mm)</span>
            <input id="pathBleedAmount" type="number" step="0.1" value="10">
          </label>
        </div>

        <div class="row" style="margin-top:10px; align-items:flex-start;">
          <div class="bleed-options-card">
            <label class="chk">
              <input id="pathBleedCutline" type="checkbox" checked>
              <span>Create cutline</span>
            </label>
            <label class="chk">
              <input id="pathBleedOutlineText" type="checkbox" checked>
              <span>Outline text</span>
            </label>
            <label class="chk">
              <input id="pathBleedOutlineStroke" type="checkbox" checked>
              <span>Outline stroke</span>
            </label>
            <label class="chk">
              <input id="pathBleedAutoWeld" type="checkbox" checked>
              <span>Auto-weld</span>
            </label>
          </div>
          <button class="btn2" id="btnApplyPathBleed" type="button" style="margin-left:auto;">
            <span>Apply path bleed</span>
            <span class="info" data-tip="Moves the target to layer 'bleed' and offsets paths. If enabled, duplicates the original to layer 'cutline' with no fill and 'Cut Contour' spot stroke.">i</span>
          </button>
        </div>

        <div class="small" style="margin-top:8px;">
          Notes: This uses path offsetting; results depend on object type. Strokes/fills are preserved on the bleed result.
        </div>
      </div>

    </section>

    <!-- TAB: CUTFILES -->
    <section id="tab-cutfiles" class="wrap hidden" role="tabpanel">
      <button class="btn" id="btnAddPathText" type="button">
        <span class="btnText">Add file path label to artboards</span>
        <span class="info" data-tip="Adds a centered label near the top of each artboard showing the current file path. Width=60% of artboard, offset=5mm. Text scales to the field width.">i</span>
      </button>

      <button class="btn" id="btnOutlineAllText" type="button">
        <span class="btnText">Outline all text</span>
        <span class="info" data-tip="Converts all text frames in the document to outlines.">i</span>
      </button>

      <button class="btn" id="btnSetFillsStrokes" type="button">
        <span class="btnText">Set fills/strokes</span>
        <span class="info" data-tip="Sets all fills to none and all strokes to 1px black across the document.">i</span>
      </button>
    </section>

    <!-- TAB: DIMENSIONS -->
    <section id="tab-dimensions" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Quick Add</div>
          <span class="info" data-tip="Adds measurement dimensions to the current selection.">i</span>
        </div>
        <div class="dim-grid">
          <button id="btnTL" class="dim-btn" type="button" title="Top + Left">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="10" x2="50" y2="10" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
              <line x1="10" y1="20" x2="10" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnT" class="dim-btn" type="button" title="Top Only">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="5 0 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="10" x2="50" y2="10" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnRT" class="dim-btn" type="button" title="Right + Top">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="10 0 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="10" x2="50" y2="10" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
              <line x1="60" y1="20" x2="60" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnL" class="dim-btn" type="button" title="Left Only">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 5 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="10" y1="20" x2="10" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnCenterText" class="dim-btn" type="button" title="Center Text">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="5" y="5" width="14" height="14" rx="1" />
              <path d="M12 7v10M7 12h10" />
            </svg>
          </button>
          <button id="btnR" class="dim-btn" type="button" title="Right Only">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="10 5 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="60" y1="20" x2="60" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnBL" class="dim-btn" type="button" title="Bottom + Left">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 10 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="60" x2="50" y2="60" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
              <line x1="10" y1="20" x2="10" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnB" class="dim-btn" type="button" title="Bottom Only">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="5 10 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="60" x2="50" y2="60" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnRB" class="dim-btn" type="button" title="Right + Bottom">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="10 10 60 60">
              <defs>
                <marker id="arrow" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <rect x="20" y="20" width="30" height="30" stroke="white" stroke-width="4" fill="none"/>
              <line x1="20" y1="60" x2="50" y2="60" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
              <line x1="60" y1="20" x2="60" y2="50" stroke="white" stroke-width="3"
                    marker-start="url(#arrow)" marker-end="url(#arrow)"/>
            </svg>
          </button>
          <button id="btnLineMeasure" class="dim-btn" type="button" title="Measure Line/Path">
            <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" viewBox="0 0 60 60">
              <defs>
                <marker id="arrowLine" viewBox="0 0 10 10" refX="5" refY="5" markerWidth="4" markerHeight="4" orient="auto-start-reverse">
                  <path d="M 0 0 L 10 5 L 0 10 z" fill="white"/>
                </marker>
              </defs>
              <line x1="10" y1="45" x2="50" y2="15" stroke="white" stroke-width="3"
                    marker-start="url(#arrowLine)" marker-end="url(#arrowLine)"/>
              <circle cx="10" cy="45" r="2" fill="white"/>
              <circle cx="50" cy="15" r="2" fill="white"/>
            </svg>
          </button>
        </div>
        <div id="dimSelectionHint" class="small dim-selection-hint hidden">Nothing Selected. Measure Artboards</div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Actions</div>
        </div>
        <div class="row">
          <button id="btnDimClear" class="btn2" type="button">Clear “Dimensions” Layer</button>
          <label class="fld" style="flex:1;">
            <span>Scale Appearance (%)</span>
            <input type="number" id="scaleAppearance" step="10" value="100">
          </label>
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Settings</div>
        </div>
        <div class="grid2">
          <label class="fld">
            <span>Offset from object (mm)</span>
            <input type="number" id="offsetMm" step="0.1" value="50">
          </label>
          <label class="fld">
            <span>Tick length (mm)</span>
            <input type="number" id="ticLenMm" step="0.1" value="50">
          </label>
          <label class="fld">
            <span>Text size (pt)</span>
            <input type="number" id="textPt" step="0.5" value="100">
          </label>
          <label class="fld">
            <span>Stroke width (pt)</span>
            <input type="number" id="strokePt" step="0.25" value="5">
          </label>
          <label class="fld">
            <span>Label decimals</span>
            <input type="number" id="decimals" step="1" value="1">
          </label>
          <label class="fld">
            <span>Label gap from line (mm)</span>
            <input type="number" id="labelGapMm" step="0.1" value="20">
          </label>
          <label class="fld">
            <span>Arrowhead size (pt)</span>
            <input type="number" id="arrowheadSizePt" step="0.5" value="50">
          </label>
          <div class="bleed-options-card" style="grid-column:1 / -1;">
            <label class="chk">
              <input type="checkbox" id="measureIncludeStroke">
              <span>Measures include stroke</span>
            </label>
            <label class="chk">
              <input type="checkbox" id="measureClippedContent">
              <span>Measure clipped content</span>
            </label>
            <label class="chk">
              <input type="checkbox" id="includeArrowhead" checked>
              <span>Include arrowhead</span>
            </label>
          </div>
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Colours</div>
        </div>
        <div class="grid3">
          <label class="fld">Text colour
            <input type="color" id="textColor" value="#000000">
          </label>
          <label class="fld">Line colour
            <input type="color" id="lineColor" value="#000000">
          </label>
        </div>
        <div class="small" style="margin-top:10px;">Quick Theme Colours</div>
        <div class="theme-grid">
          <button class="theme-tile" type="button" title="Black / Black" data-text-color="#000000" data-line-color="#000000">
            <span class="theme-tile-inner">
              <span class="theme-half" style="background:#000000;"></span>
              <span class="theme-half" style="background:#000000;"></span>
            </span>
          </button>
          <button class="theme-tile" type="button" title="Pink / Pink" data-text-color="#ff00ff" data-line-color="#ff00ff">
            <span class="theme-tile-inner">
              <span class="theme-half" style="background:#ff00ff;"></span>
              <span class="theme-half" style="background:#ff00ff;"></span>
            </span>
          </button>
          <button class="theme-tile" type="button" title="Red / Red" data-text-color="#ff0000" data-line-color="#ff0000">
            <span class="theme-tile-inner">
              <span class="theme-half" style="background:#ff0000;"></span>
              <span class="theme-half" style="background:#ff0000;"></span>
            </span>
          </button>
          <button class="theme-tile" type="button" title="Red / Black" data-text-color="#ff0000" data-line-color="#000000">
            <span class="theme-tile-inner">
              <span class="theme-half" style="background:#ff0000;"></span>
              <span class="theme-half" style="background:#000000;"></span>
            </span>
          </button>
          <button class="theme-tile" type="button" title="White / White" data-text-color="#ffffff" data-line-color="#ffffff">
            <span class="theme-tile-inner">
              <span class="theme-half" style="background:#ffffff;"></span>
              <span class="theme-half" style="background:#ffffff;"></span>
            </span>
          </button>
        </div>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Log</div>
        </div>
        <div id="dimensionsLog" class="log"></div>
      </div>
    </section>

    <!-- TAB: TRANSFORM -->
    <section id="tab-transform" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Transform Mode</div>
        </div>
        <label class="fld">
          <span>Mode</span>
          <select id="transformMode">
            <option value="selection">Selection</option>
            <option value="artboard">Artboard (active)</option>
            <option value="artboards">Artboards (selected)</option>
          </select>
        </label>
      </div>

      <div class="card" style="margin-top:12px;">
        <div class="cardHead">
          <div class="cardTitle">Make Size</div>
        </div>
        <div class="grid2">
          <label class="fld">
            <span>Width (mm)</span>
            <input id="transformWidthMm" type="text" value="" placeholder="200mm or +20 or - / *">
            <span class="small">Supports + - * / (example: +20)</span>
          </label>
          <label class="fld">
            <span>Height (mm)</span>
            <input id="transformHeightMm" type="text" value="" placeholder="200mm or +20 or - / *">
          </label>
        </div>
        <div class="small" style="margin-top:8px;">Origin</div>
        <div id="transformOriginGrid" class="origin-grid" style="margin-top:8px;">
          <button type="button" class="origin-btn" data-origin="TL">Top Left</button>
          <button type="button" class="origin-btn" data-origin="TM">Top</button>
          <button type="button" class="origin-btn" data-origin="TR">Top Right</button>
          <button type="button" class="origin-btn" data-origin="LM">Left</button>
          <button type="button" class="origin-btn active" data-origin="C">Center</button>
          <button type="button" class="origin-btn" data-origin="RM">Right</button>
          <button type="button" class="origin-btn" data-origin="BL">Bottom Left</button>
          <button type="button" class="origin-btn" data-origin="BM">Bottom</button>
          <button type="button" class="origin-btn" data-origin="BR">Bottom Right</button>
        </div>
        <input type="hidden" id="transformOrigin" value="C">
        <label class="chk" style="margin-top:10px;">
          <input id="transformExcludeStroke" type="checkbox" checked>
          <span>Exclude stroke from size</span>
        </label>
        <div id="transformArtboardsWrap" class="artboards-wrap hidden">
          <div class="artboards-head">
            <span class="small">Target artboards (panel selection)</span>
            <button id="btnTransformRefreshArtboards" class="btn2" type="button" style="padding:6px 8px;font-size:12px;">Refresh</button>
          </div>
          <div id="transformArtboardsList" class="artboards-list">
            <div class="artboards-empty">No artboards loaded.</div>
          </div>
          <input type="hidden" id="transformArtboardIndices" value="">
        </div>
        <div class="row" style="margin-top:12px;">
          <button id="btnTransformApply" class="btn2" type="button">Transform</button>
        </div>
      </div>
    </section>

    <!-- TAB: COREBRIDGE -->
    <section id="tab-corebridge" class="wrap hidden" role="tabpanel">
      <button class="btn" id="btnCorebridgeCreateLink" type="button">
        <span class="btnText">Create Link</span>
        <span class="info" data-tip="Creates a Corebridge link badge in the center of the current view. Select it to open Corebridge in browser.">i</span>
      </button>
      <button class="btn" id="btnCorebridgePullData" type="button">
        <span class="btnText">Pull Data</span>
        <span class="info" data-tip="Fetches async JSON from the Corebridge design endpoint and dumps it below.">i</span>
      </button>
      <textarea id="corebridgeDataDump" class="log" style="height:220px;" readonly></textarea>
    </section>

    <!-- TAB: LIGHTBOX -->
    <section id="tab-lightbox" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Lightbox</div>
          <span class="info" data-tip="Creates a lightbox frame, supports, and an LED panel offset from the frame.">i</span>
        </div>
        <div class="grid2">
          <label class="fld">
            <span>Width (mm)</span>
            <input type="number" id="lightboxWidthMm" step="1" value="1000">
          </label>
          <label class="fld">
            <span>Height (mm)</span>
            <input type="number" id="lightboxHeightMm" step="1" value="500">
          </label>
          <label class="fld">
            <span>Depth (mm)</span>
            <input type="number" id="lightboxDepthMm" step="1" value="100">
          </label>
          <label class="fld">
            <span>Lightbox type</span>
            <select id="lightboxType">
              <option value="Acrylic">Acrylic</option>
              <option value="Flexface">Flexface</option>
            </select>
          </label>
          <label class="fld">
            <span>Number of supports</span>
            <input type="number" id="lightboxSupportCount" step="1" value="2">
            <span id="lightboxSupportSpacingInfo" class="small" style="display:block; margin-top:4px; color:#9a9a9a;">Support spacing: -</span>
          </label>
          <label class="fld">
            <span>LED panel offset (mm)</span>
            <input type="number" id="lightboxLedOffsetMm" step="1" value="4">
          </label>
        </div>
        <div class="row" style="margin-top:10px; align-items:center;">
          <label class="chk">
            <input id="lightboxAddMeasures" type="checkbox" checked>
            <span>Add measures</span>
          </label>
        </div>
        <div class="row" style="margin-top:6px; align-items:center;">
          <label class="chk">
            <input id="lightboxUpdateMeasuresLive" type="checkbox" checked>
            <span>Update measures live</span>
          </label>
        </div>
        <div class="row" style="margin-top:10px;">
          <button id="btnCreateLightbox" class="btn2" type="button">Create lightbox</button>
          <button id="btnCreateLightboxWithLedPanel" class="btn2" type="button">Create lightbox + LED panel</button>
        </div>
        <div id="lightboxArtboardScaleNotice" class="artboard-scale-banner" aria-live="polite">
          <span id="lightboxArtboardScaleIcon">✅</span>
          <span id="lightboxArtboardScaleText">Standard artboard scale detected.</span>
        </div>
      </div>

        <div class="card" style="margin-top:12px;">
          <div class="cardHead">
            <div class="cardTitle">LED Layout</div>
            <span class="info" data-tip="Draws LED modules based on the Lightbox width/height and depth, or the current selection bounds.">i</span>
          </div>
          <div class="row" style="margin-bottom:10px; align-items:flex-end; gap:12px;">
            <div style="border:1px solid #333; border-radius:10px; padding:10px; background:#101010; display:flex; align-items:center; gap:10px;">
              <div id="ledDepiction" style="width:140px;height:70px;display:grid;place-items:center;border:1px dashed #444;border-radius:8px;background:#151515;position:relative;">
                <div id="ledDepictionRect" style="width:90px;height:26px;border:1px solid #ddd;position:relative;">
                  <div id="ledDepictionLine" style="position:absolute;left:0;right:0;top:50%;height:1px;background:#ff3b3b;"></div>
                </div>
              </div>
              <div style="font-size:12px;color:#bcbcbc;">
                <div id="ledDepictionText">LED 66mm × 13mm</div>
                <div style="color:#888;">Width × Height</div>
              </div>
            </div>
          </div>
          <div class="grid2">
            <label class="fld">
              <span>Layout Width (mm)</span>
              <input type="number" id="ledLayoutWidthMm" step="1" value="1000">
            </label>
            <label class="fld">
              <span>Layout Height (mm)</span>
              <input type="number" id="ledLayoutHeightMm" step="1" value="500">
            </label>
            <label class="fld">
              <span>Max LEDs in Series</span>
              <input type="number" id="ledMaxInSeries" step="1" value="50">
            </label>
            <label class="chk" style="align-items:center; gap:8px; margin-top:6px;">
              <input type="checkbox" id="ledFlip">
              <span>Flip LED</span>
            </label>
            <label class="fld">
              <span>LED Watt</span>
              <input type="number" id="ledWatt" step="0.01" value="1.5">
            </label>
            <label class="fld">
              <span>LED Code</span>
              <input type="text" id="ledCode" value="">
            </label>
            <label class="fld">
              <span>LED Voltage</span>
              <input type="number" id="ledVoltage" step="0.1" value="12">
            </label>
            <label class="fld">
            <span>LED Width (mm)</span>
            <input type="number" id="ledWidthMm" step="1" value="66">
          </label>
          <label class="fld">
            <span>LED Height (mm)</span>
            <input type="number" id="ledHeightMm" step="1" value="13">
          </label>
          <label class="fld">
            <span>Allowance Between Centers (W)</span>
            <input type="number" id="ledAllowanceWmm" step="1" value="0">
          </label>
          <label class="fld">
            <span>Allowance Between Centers (H)</span>
            <input type="number" id="ledAllowanceHmm" step="1" value="0">
          </label>
        </div>
        <div class="row" style="margin-top:10px;">
          <button id="btnDrawLEDs" class="btn2" type="button">Draw LED Layout</button>
        </div>
        <div class="small" style="margin-top:8px;">
          Note: uses Lightbox Width/Height/Depth if no selection is active.
        </div>
      </div>
    </section>

    <!-- TAB: COLOURS -->
    <section id="tab-colours" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Document Colours</div>
          <span class="info" data-tip="Lists unique vector colours. Change a picker to update items using the previous colour.">i</span>
        </div>
        <div id="coloursList" class="wrap" style="padding:0;"></div>
        <div class="row" style="margin-top:10px;">
          <button id="btnRefreshColours" class="btn2" type="button">Refresh Colours</button>
        </div>
        <div id="coloursCount" class="small" style="margin-top:8px;">Document colours: 0</div>
        <div id="colourModeBanner" style="display:none; margin-top:12px; padding:8px 10px; border-radius:8px; background:#b00020; color:#fff; font-size:12px; font-weight:600;">
          Current document colour mode is RGB
        </div>
      </div>
    </section>

    <!-- TAB: TESTING -->
    <section id="tab-testing" class="wrap hidden" role="tabpanel">
      <div class="card">
        <div class="cardHead">
          <div class="cardTitle">Console</div>
          <button class="tab" id="btnClearLog" type="button" style="border-radius:10px;">Clear</button>
        </div>
        <div id="log"></div>
      </div>
    </section>
  </div>

  <script src="js/CSInterface.js"></script>
  <script src="js/main.js"></script>
</body>
</html>

